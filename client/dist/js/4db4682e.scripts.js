!function(){"use strict";window.cfg||(window.cfg={hostAndPort:function(){return"//"+window.location.host},host:function(){return"http://"+window.location.host.replace(/:[0-9]+$/,"")},apiBaseUrl_set:"",apiBaseUrl:function(){return this.apiBaseUrl_set?this.apiBaseUrl_set:(this.hostAndPort().match(/isleofravens.com/)?(this.server="//app.isleofravens.com",this.basehref="/"):this.host().match(/(192.)/)?(console.log(this.hostAndPort()),this.server=this.hostAndPort()+"/isleofravens/server/",this.basehref="/isleofravens/client/"):(this.hostAndPort().match(/:8888/)||this.host().match(/(localh|127.0.0|0.0.0)/))&&(this.server="//localhost:8888/isleofravens/server/",this.basehref="/isleofravens/client/"),this.apiBaseUrl_set=this.server,this.apiBaseUrl_set)}})}();var app=angular.module("isleOfRavensApp",["ngRoute","restangular","templates-main","ui.bootstrap","angularModalService"]);app.run(["$rootScope",function(rs){rs.baseURL=cfg.baseHref}]),app.config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){"use strict";$locationProvider.html5Mode(!0),$routeProvider.when("/",{templateUrl:"js/search/main.html",controller:"MainController"}).when("/search",{templateUrl:"js/search/search.html",controller:"SearchController"}).when("/page/:page",{templateUrl:"js/search/main.html",controller:"MainController"}).when("/player/:playerID",{templateUrl:"js/search/main.html",controller:"MainController"}).when("/stats",{templateUrl:"js/stats/stats.html",controller:"MainController"}).when("/faq",{templateUrl:"js/faq/faq.html",controller:"FaqController"}).when("/contact",{templateUrl:"js/contact/contact.html",controller:"ContactController"}).when("/whats-new",{templateUrl:"js/whatsnew/whatsnew.html",controller:"WhatsNewController"}).otherwise({redirectTo:"/"})}]).run(["Restangular","$rootScope",function(RestProvider,rs){"use strict";RestProvider.setBaseUrl(cfg.apiBaseUrl())}]),app.factory("Api",["Restangular","$rootScope","$q","$location","$http",function(Rest,$rootScope,$q,$location,$http){"use strict";window.Api=this;return{searchPlayers:function(opts){return Rest.all("player/search/").post(opts)},loadPlayerByID:function(playerID){return Rest.one("player/"+playerID).get(playerID)},loadTopPlayers:function(opts){return Rest.all("player/top/?offset="+opts.offset+"&limit="+opts.limit).get("")},loadTournamentsByPlayer:function(player_id){return Rest.all("player/tournaments/").get(player_id)},loadTournamentRoundsByPlayer:function(tournament_id,player_id){return Rest.all("tournament/rounds/"+tournament_id+"/").get(player_id)},loadFactionWinLoss:function(playerID){return Rest.one("player/faction/winloss/"+playerID).get(playerID)},loadFactionEntries:function(){return Rest.all("stats/factions/entries/").get("")},loadFactionWins:function(){return Rest.all("stats/factions/wins/").get("")},loadFactionMatchups:function(opts){return Rest.all("stats/faction/matchups/").post(opts)},loadFactionMatchupDetails:function(opts){return Rest.all("stats/faction/matchup_details/").post(opts)},loadFactions:function(){return Rest.all("factions/").get("")},sendMail:function(opts){return console.log("api : "),console.log(opts),Rest.all("send-mail/").post(opts)}}}]);var MainCtrl=app.controller("MainController",["$scope","Restangular","$routeParams","$route","$location","$q","Api","PlayerSearch",function($scope,Rest,$routeParams,$route,$location,$q,Api,PlayerSearch){$scope.search_str="",$scope.players=[],$scope.top_players=[],$scope.loading=!1,$scope.page=1,$routeParams.page&&($scope.page=$routeParams.page),$scope.loadPlayer=function(id){$scope.loading=!0,Api.loadPlayerByID(id).then(function(res){$scope.players.push(res.data),$scope.loading=!1})},$routeParams.playerID&&$scope.loadPlayer($routeParams.playerID)}]);angular.module("templates-main",["js/contact/contact.html","js/faq/faq.html","js/header/header.tpl.html","js/player/faction_winloss.html","js/player/player_details.html","js/player/player_nemesis.html","js/player/player_rival.html","js/player/player_rounds.html","js/player/player_tournaments.html","js/player/top_players.html","js/search/main.html","js/search/search_form.tpl.html","js/search/search.html","js/stats/faction_matchups.html","js/stats/faction_wins_linechart.html","js/stats/match_details.html","js/stats/played_factions_linechart.html","js/stats/stats.html","js/whatsnew/whatsnew.html"]),angular.module("js/contact/contact.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/contact/contact.html",'<div class="col-lg-12 col-md-12 col-sm-12">\n  <div class="alert alert-danger" ng-show="error">\n    <button class="close" data-dismiss="alert">x</button>\n    <strong>Error!</strong> An error occured while trying to send message.\n  </div>\n  <div class="alert alert-success" ng-show="success">\n    <button class="close" data-dismiss="alert">x</button>\n    <strong>Success! </strong> Your message was successfully sent.\n  </div>\n  <div ng-if="!success">\n    <div class="form-group" ng-class="{error: contactForm.name.$invalid}">\n    <label>Full Name</label>\n    <input class="form-control" type="text" name="name" ng-model="user.name" required="required" placeholder="Your name">\n      <span class="help-block" ng-show="contactForm.name.$error.required">Required</span>\n    </div>\n    <div class="form-group" ng-class="{error: contactForm.email.$invalid}">\n      <label>Email</label>\n      <input class="form-control" type="email" name="email" ng-model="user.email" required="required" placeholder="Your email address">\n      <span class="help-block" ng-show="contactForm.email.$error.required">Required</span>\n      <span class="help-block" ng-show="contactForm.email.$error.email">Invalid email address</span>\n    </div>\n    <div class="form-group" ng-class="{error: contactForm.message.$invalid}">\n      <label>Message</label>\n      <textarea class="form-control" rows="5" name="message" ng-model="user.message" required="required" placeholder="Your messsage"></textarea>\n      <span class="help-inline" ng-show="contactForm.message.$error.required">Required</span>\n    </div>\n    <button class="btn btn-primary btn-lg btn-block" ng-click="send()" ng-disabled="contactForm.$invalid">Send</button>\n    </div>\n</div>')}]),angular.module("js/faq/faq.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/faq/faq.html",'<div class="panel-group" id="accordion">\n\t<div class="panel panel-default" ng-repeat="faq in faqs">\n\t\t<div class="panel-heading">\n\t\t\t<h4 class="panel-title">\n\t\t\t\t<a class="accordion-toggle" ng-class="$index!=0?\'collapsed\':\'\'" href="javascript:void(0);" data-toggle="collapse" data-parent="#accordion" data-target="#collapse{{faq.id}}" aria-expanded="false">{{faq.q}}</a>\n\t\t\t</h4>\n\t\t</div>\n\t\t<div id="collapse{{faq.id}}" class="panel-collapse collapse"  ng-class="$index!=0?\'\':\'in\'" aria-expanded="false">\n\t\t\t<div class="panel-body">\n\t\t\t\t<div ng-bind-html="toTrustedHTML(faq.a)"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>')}]),angular.module("js/header/header.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/header/header.tpl.html",'<nav class="navbar navbar-default navbar-fixed-top">\n      <div class="container">\n        <div class="navbar-header">\n          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">\n            <span class="sr-only">Toggle navigation</span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n            <span class="icon-bar"></span>\n          </button>\n      \t\t<a class="navbar-brand" href="{{baseURL}}">\n        \t\t<img alt="Raven" style="height:45px; width:auto; margin-top:-12px;" src="img/raven.png">\n      \t\t</a>\n      \t\t<b class="navbar-brand"><a href="{{baseURL}}" style="color:black; hover:black; active:black">Isle of Ravens</a></b>\n        </div>\n        <div id="navbar" class="navbar-collapse collapse" aria-expanded="false" style="height: 1px;">\n          <ul class="nav navbar-nav navbar-right">\n            <li active-link="active" link="{{baseURL}}"><a href="{{baseURL}}">Home</a></li>\n            \x3c!-- <li active-link="active" link="{{baseURL}}stats"><a href="{{baseURL}}stats">Stats</a></li>  --\x3e\n\t\t\t<li active-link="active" link="{{baseURL}}faq"><a href="{{baseURL}}faq">FAQ</a></li>\n\t\t\t<li active-link="active" link="{{baseURL}}whats-new"><a href="{{baseURL}}whats-new">What\'s New</a></li>\n\t\t\t<li active-link="active" link="{{baseURL}}contact"><a href="{{baseURL}}contact">Contact</a></li>\n          </ul>\n        </div>\x3c!--/.nav-collapse --\x3e\n      </div>\n</nav>\n\n\n\n\x3c!--\n<nav class="navbar navbar-default">\n\t<div class="container-fluid">\n    \t<div class="navbar-header">\n    \t\t<h3 class="visible-xs pull-right" style="margin-right:16px !important;"><a href="{{baseURL}}" style="color:black; hover:black; active:black">Isle of Ravens</a></h3>\n      \t\t<a class="navbar-brand" href="{{baseURL}}">\n        \t\t<img alt="Raven" style="height:45px; width:auto; margin-top:-6px;" src="img/raven.png">\n      \t\t</a>\n    \t</div>\n\t<div class="col-xs-8 hidden-xs" style="padding-bottom:4px !important;">\n\t\t<h2 style="margin-top:8px !important; margin-bottom:0px !important;"><a href="{{baseURL}}" style="color:black; hover:black; active:black">Isle of Ravens</a></h2>\n\t\t<i class="hidden-xs text-center" >Elo ranking and tournament details for AGoT LCG</i>\n\t</div>\n  \n  <div class="collapse navbar-collapse navbar-right" id="bs-example-navbar-collapse-1">\n\t<ul class="nav navbar-nav">\n\t\t<li><a href="{{baseURL}}" style="line-height:28px !important;">Home</a></li>\n\t\t<li><a href="{{baseURL}}faq" style="line-height:28px !important;">FAQ</a></li>\n\t\t<li><a href="{{baseURL}}contact" style="line-height:28px !important;">Contact</a></li>\n\t</ul>\n  </div>\n  </div>\n</nav>\n--\x3e\n')}]),angular.module("js/player/faction_winloss.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/faction_winloss.html",'<div>\n\t<div class="col-xs-6">\n\t\t<b>Win/Loss by Faction</b>\n\t\t<canvas id="fwl-{{player}}"></canvas>\n\t</div>\n\n\t<div class="col-xs-4">\n\t\t<b>Win Distribution</b>\n\t\t<div class="pie-group">\n\t\t    <canvas id="wd-outter-{{player}}" class="pie-1" height="300" width="300"></canvas>\n\t\t    <canvas id="wd-{{player}}" class="pie-2" height="280" width="280"></canvas>\n\t\t</div>\n\t\t<div class="chartjs-tooltip" id="wd-{{player}}-tooltip">zxzx</div>\n\t</div>\n</div>\n')}]),angular.module("js/player/player_details.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/player_details.html",'<div>\n\t<div class="card">\n\t\t<div class="panel-heading">\n\t\t\t<h2><a href="player/{{player.player_id}}">{{player.name}}</a> ({{player.elo}})</h2>\n\t\t</div>\n\t  \t<div class="panel-body">\n\t   \t\t<div class="row">\n\t   \t\t\t<div class="col-xs-6 col-md-3">\n\t   \t\t\t\t<div class="col-xs-12"><b>Entries</b></div>\n\t   \t\t\t\t<div class="col-xs-12">{{player.entries}}</div>\n\t   \t\t\t</div>\n\t\t\t\t<div class="col-xs-6 col-md-3">\n\t   \t\t\t\t<div class="col-xs-12"><b>Win</b></div>\n\t   \t\t\t\t<div class="col-xs-12">{{player.wins}}</div>\n\t   \t\t\t</div>\n\t\t\t\t<div class="col-xs-6 col-md-3">\n\t   \t\t\t\t<div class="col-xs-12"><b>Loss</b></div>\n\t   \t\t\t\t<div class="col-xs-12">{{player.losses}}</div>\n\t   \t\t\t</div>\n\t\t\t\t<div class="col-xs-6 col-md-3">\n\t   \t\t\t\t<div class="col-xs-12"><b>Win%</b></div>\n\t   \t\t\t\t<div class="col-xs-12">\n\t   \t\t\t\t\t<span ng-if="player.name == \'Gabriel Saravia\'">90%!!!</span>\n\t   \t\t\t\t\t<span ng-if="player.name != \'Gabriel Saravia\'">{{ ((player.wins/(player.wins+player.losses))*100).toFixed(2) }}%</span>\n\t   \t\t\t\t\t\n\t   \t\t\t\t</div>\n\t   \t\t\t</div>\n\t   \t\t</div>\n\t   \t\t\n\t   \t\t<div class="row">\n\t   \t\t\t<hr></hr>\n\t   \t\t\t<faction-winloss player="player.player_id">Loading ...</faction-winloss>\n\t   \t\t\t<div class="clearfix"></div>\n\t   \t\t\t<hr></hr>\n\t   \t\t</div>\n\t\t\t   \t\t\n\t   \t\t<div class="row">\n\t   \t\t\t<div class="col-xs-12 col-md-6">\n\t   \t\t\t\t<player-nemesis player="player"></player-nemesis>\n\t   \t\t\t</div>\n\t\t\t   \t\t\t\n\t\t\t\t<div class="col-xs-12 col-md-6">\n\t\t\t\t\t<player-rival player="player"></player-rival>\n\t\t\t\t</div>\n\t\t\t   \t\t\t\n\t\t\t</div>\n\t\t   \t\t\n\t\t   \t\n\t \t</div>\n\t</div>\n\t\n\t<div >\n\t\t<div class="col-xs-12 text-center">\n\t\t\t<player-tournaments player="player"></player-tournaments>\n\t\t</div>\n\t</div>\n\t\n</div>')}]),angular.module("js/player/player_nemesis.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/player_nemesis.html",'<div>\n\t<h3>Nemeses</h3>\n\t<table ng-if="player.nemeses.length > 0" class="table table-responsive">\n\t\t<tr>\n\t\t\t<td>Nemesis</td>\n\t\t\t<td>Win</td>\n\t\t\t<td>Loss</td>\n\t\t</tr>\n\t\t<tr ng-repeat="nemesis in player.nemeses">\n\t\t\t<td><a href="player/{{nemesis.winner_id}}">{{nemesis.name}} ({{nemesis.elo}})</a></td>\n\t\t\t<td>{{nemesis.rounds_played-nemesis.defeats}}\n\t\t\t<td>{{nemesis.defeats}}</td>\n\t\t</tr>\n\t</table>\n\t<i ng-if="player.nemeses.length < 1">Play more matches.  Make more enemies.</i>\n</div>')}]),angular.module("js/player/player_rival.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/player_rival.html",'<div>\n\t<h3>Rivals</h3>\n\t<table ng-if="player.rivals.length > 0" class="table table-responsive">\n\t\t<tr>\n\t\t\t<td>Rival</td>\n\t\t\t<td>Win</td>\n\t\t\t<td>Loss</td>\n\t\t</tr>\n\t\t<tr ng-repeat="rival in player.rivals">\n\t\t\t<td><a href="player/{{rival.loser_id}}">{{rival.name}} ({{rival.elo}})</a></td>\n\t\t\t<td>{{rival.wins}}\n\t\t\t<td>{{rival.rounds_played - rival.wins}}</td>\n\t\t</tr>\n\t</table>\n\t<i ng-if="player.rivals.length < 1">Play more matches.  BE the enemy.</i>\n</div>')}]),angular.module("js/player/player_rounds.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/player_rounds.html",'<div class="text-center">\n\t<a href="javascript:void(0);" class="collapsed" data-toggle="collapse" data-target="#collapseRounds-{{tid}}" aria-expanded="false" aria-controls="collapseExample">\n\t\t<span class="if-collapsed" ng-click="loadPlayerRounds()">Show Rounds</span>\n\t\t<span class="if-not-collapsed">Hide Rounds</span>\n\t</a>\n\t<div class="collapse text-left" id="collapseRounds-{{tid}}">\n\t\t<table class="table table-response">\n\t\t\t<tr>\n\t\t\t\t<td>Round#</td>\n\t\t\t\t<td>Result</td>\n\t\t\t\t<td>End Eol</td>\n\t\t\t\t<td>Start Eol</td>\n\t\t\t\t<td>Change</td>\n\t\t\t\t<td>Opponent</td>\n\t\t\t\t<td>End Eol</td>\n\t\t\t\t<td>Start Eol</td>\n\t\t\t\t<td>Change</td>\n\t\t\t</tr>\n\t\t\t<tbody>\n\t\t\t\t<tr ng-repeat="r in rounds">\n\t\t\t\t\t<td>{{r.round_number}}</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.winner_id == player.player_id" style="color:green">Win</span>\n\t\t\t\t\t\t<span ng-if="r.winner_id != player.player_id" style="color:red">Loss</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">{{r.player_1_end_elo}}</span>\n\t\t\t\t\t\t<span ng-if="r.player_1_id != player.player_id">{{r.player_2_end_elo}}</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">{{r.player_1_start_elo}}</span>\n\t\t\t\t\t\t<span ng-if="r.player_1_id != player.player_id">{{r.player_2_start_elo}}</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">\n\t\t\t\t\t\t\t<span ng-if="r.player_1_end_elo-r.player_1_start_elo > 0" style="color:green">{{r.player_1_end_elo-r.player_1_start_elo}}</span>\n\t\t\t\t\t\t\t<span ng-if="r.player_1_end_elo-r.player_1_start_elo <= 0" style="color:red">{{r.player_1_end_elo-r.player_1_start_elo}}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span ng-if="r.player_2_id == player.player_id">\n\t\t\t\t\t\t\t<span ng-if="r.player_2_end_elo-r.player_2_start_elo > 0" style="color:green">{{r.player_2_end_elo-r.player_2_start_elo}}</span>\n\t\t\t\t\t\t\t<span ng-if="r.player_2_end_elo-r.player_2_start_elo <= 0" style="color:red">{{r.player_2_end_elo-r.player_2_start_elo}}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td><a href="player/{{r.opponent.player_id}}">{{r.opponent.name}}</a> ({{r.opponent.elo}})</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">{{r.player_2_end_elo}}</span>\n\t\t\t\t\t\t<span ng-if="r.player_1_id != player.player_id">{{r.player_1_end_elo}}</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">{{r.player_2_start_elo}}</span>\n\t\t\t\t\t\t<span ng-if="r.player_1_id != player.player_id">{{r.player_1_start_elo}}</span>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<span ng-if="r.player_1_id == player.player_id">\n\t\t\t\t\t\t\t<span ng-if="r.player_2_end_elo-r.player_2_start_elo > 0" style="color:green">{{r.player_2_end_elo-r.player_2_start_elo}}</span>\n\t\t\t\t\t\t\t<span ng-if="r.player_2_end_elo-r.player_2_start_elo <= 0" style="color:red">{{r.player_2_end_elo-r.player_2_start_elo}}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span ng-if="r.player_2_id == player.player_id">\n\t\t\t\t\t\t\t<span ng-if="r.player_1_end_elo-r.player_1_start_elo > 0" style="color:green">{{r.player_1_end_elo-r.player_1_start_elo}}</span>\n\t\t\t\t\t\t\t<span ng-if="r.player_1_end_elo-r.player_1_start_elo <= 0" style="color:red">{{r.player_1_end_elo-r.player_1_start_elo}}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n \t</div>\n \t<hr></hr>\n</div>')}]),angular.module("js/player/player_tournaments.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/player_tournaments.html",'<div>\n\t<a href="javascript:void(0);" class="collapsed" data-toggle="collapse" data-target="#collapseTournaments-{{player.player_id}}" aria-expanded="false" aria-controls="collapseExample">\n\t\t<span class="if-collapsed" ng-click="loadPlayerTournaments()">Show Tournaments</span>\n\t\t<span class="if-not-collapsed">Hide Tournaments</span>\n  \t</a>\n\t<div class="collapse text-left" id="collapseTournaments-{{player.player_id}}">\n  \t\t<div>\n  \t\t\t<div class="row card" ng-repeat="t in tournaments">\n\t  \t\t\t<h3 class="text-left">{{t.name}}</h3>\n    \t\t\t\n\t\t\t\t<div class="row">\n    \t\t\t\t<div class="col-xs-12">\n    \t\t\t\t\t<b>{{t.faction}} {{t.agenda}}</b><br/>\n    \t\t\t\t\t<span ng-if="t.end_elo > 0 && t.end_elo - t.start_elo > 0" style="color:green">{{t.end_elo - t.start_elo}}</span>\n    \t\t\t\t\t<span ng-if="t.end_elo > 0 && t.end_elo - t.start_elo <= 0"style="color:red">{{t.end_elo - t.start_elo}}</span>\n    \t\t\t\t\t<br/>\n    \t\t\t\t</div>\n    \t\t\t</div>\n    \t\t\t\n\t\t\t\t<div class="row">\n\t\t   \t\t\t<div class="col-xs-6 col-md-3">\n\t\t   \t\t\t\t<div class="col-xs-12"><b>End Elo</b></div>\n\t\t   \t\t\t\t<div class="col-xs-12">{{t.end_elo}}</div>\n\t\t   \t\t\t</div>\n\t\t\t\t\t<div class="col-xs-6 col-md-3">\n\t\t   \t\t\t\t<div class="col-xs-12"><b>Start Elo</b></div>\n\t\t   \t\t\t\t<div class="col-xs-12">{{t.start_elo}}</div>\n\t\t   \t\t\t</div>\n\t\t\t\t\t<div class="col-xs-6 col-md-3">\n\t\t   \t\t\t\t<div class="col-xs-12"><b>Players</b></div>\n\t\t   \t\t\t\t<div class="col-xs-12">{{t.player_count}}</div>\n\t\t   \t\t\t</div>\n\t\t\t\t\t<div class="col-xs-6 col-md-3">\n\t\t   \t\t\t\t<div class="col-xs-12"><b>Date</b></div>\n\t\t   \t\t\t\t<div class="col-xs-12">{{t.date_end}}</div>\n\t\t   \t\t\t</div>\n\t\t   \t\t</div>\n\t\t   \t\t<player-rounds tid="t.tournament_id" player="player"></player-rounds>\n\t\t   \t\t\n   \t\t\t</div>\n  \t\t\n  \t\t</div>\n  \t</div>\n</div>')}]),angular.module("js/player/top_players.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/player/top_players.html",'<div>\n\t<h3>Top Players</h3>\n\t<table class="table table-responsive table-hover table-striped">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t<th>#</th>\n\t\t\t\t<th>Name</th>\n\t\t\t\t<th>Elo</th>\n\t\t\t\t<th>Wins</th>\n\t\t\t\t<th>Losses</th>\n\t\t\t\t<th>Entries</th>\n\t\t\t\t<th>Most Played</th>\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="player in top_players">\n\t\t\t\t<td>{{$index+1+pagination.offset}}</td>\n\t\t\t\t<td><a href="player/{{player.player_id}}">{{player.name}}</a></td>\n\t\t\t\t<td>{{player.elo}}</td>\n\t\t\t\t<td>{{player.wins}}</td>\n\t\t\t\t<td>{{player.losses}}</td>\n\t\t\t\t<td>{{player.entries}}</td>\n\t\t\t\t<td>{{player.most_played_faction}}</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n\t<div class="text-center">\n\t\t<ul ng-if="pagination.total" uib-pagination total-items="pagination.total" items-per-page="20" ng-model="pagination.page" max-size="10" ng-change="changePage()" class="pagination-sm" boundary-link-numbers="true"></ul>\n\t</div>\n</div>')}]),angular.module("js/search/main.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/search/main.html",'<style>\n[data-toggle="collapse"].collapsed .if-not-collapsed {\n  display: none;\n}\n[data-toggle="collapse"]:not(.collapsed) .if-collapsed {\n  display: none;\n}\n</style>\n\n<div class="clearfix"></div>\n\n\n<div ng-if="loading">Loading...</div>\n\n<div ng-if="players.length <= 0 && !loading" class="col-xs-12 col-md-12">\n\t<top-players page="page">Loading...</top-players>\n</div>\n\n<div ng-if="players.length > 0 && !loading">\n\t<div ng-repeat="player in players">\n\t\t<div class="panel panel-default">\n\t\t\t<player-details player="player"></player-details>\n\t\t</div>\n\t\t<br/>\n\t</div>\n</div>\n')}]),angular.module("js/search/search_form.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/search/search_form.tpl.html",'<div class="row">\n\t<div class="text-right">\n\t\t<form class="form-inline">\n\t\t  <div class="form-group">\n\t\t      <input type="text" class="form-control" id="playerSearch" name="name" placeholder="Player Name" ng-model="ps.search_str" />\n\t\t  </div>\n\t\t  <button ng-click="searchPlayer()" class="btn btn-small btn-default">Search</button>\n\t\t</form>\n\t</div>\n</div>')}]),angular.module("js/search/search.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/search/search.html",'<style>\n[data-toggle="collapse"].collapsed .if-not-collapsed {\n  display: none;\n}\n[data-toggle="collapse"]:not(.collapsed) .if-collapsed {\n  display: none;\n}\n</style>\n\n<div ng-if="loading">Loading...</div>\n\n<div ng-if="ps.players.length > 0 && !loading">\n\t\n\t\t<div ng-repeat="player in ps.players" class="card">\n\t\t\t<div class="panel panel-default">\n\t\t\t\t<div ng-if="ps.players.length > 1">\n\t\t\t\t\t<div class="panel-heading">\n\t\t\t\t\t\t<h2><a href="player/{{player.player_id}}">{{player.name}}</a> ({{player.elo}})</h2>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<player-details ng-if="ps.players.length == 1" player="player"></player-details>\n\t\t\t</div>\n\t\t</div>\n</div>\n')}]),angular.module("js/stats/faction_matchups.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/stats/faction_matchups.html",'<div>\n\t<div class="card col-xs-12" style="min-width:800px;">\n\t\t<h3>Faction Matchups</h3>\n\t\t\n\t\t<form class="form-inline">\n\t\t\n\t\t\t<div class="form-group">\n\t\t\t\t\n    \t\t\t<label>Faction</label>\n    \t\t\t<div class="clearfix"></div>\n\t\t\t\t<select class="form-control" ng-model="search.faction">\n\t\t\t\t\t<option ng-repeat="faction in factions" ng-selected="faction.faction == search.faction">{{faction.faction}}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class="form-group">\n\t\t\t\t<label>Agenda</label>\n\t\t\t\t<div class="clearfix"></div>\n\t\t\t\t<select class="form-control" ng-model="search.agenda">\n\t\t\t\t\t<option ng-repeat="agenda in agendas" ng-selected="agenda.agenda == search.agenda">{{agenda.agenda}}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\n\t\t  \t<div class="form-group">\n\t\t  \t\t<label>From</label>\n\t\t  \t\t<div class="clearfix"></div>\n\t\t\t\t<input type="text" class="form-control" id="date" name="date" placeholder="From Date" ng-model="search.date" />\n\t\t\t</div>\n\t\t\t<div class="form-group">\n\t\t  \t\t<label>Match Threshold</label>\n\t\t  \t\t<div class="clearfix"></div>\n\t\t\t\t<input type="text" class="form-control" id="date" name="date" ng-model="threshold" />\n\t\t\t</div>\n\t\t  \t<button ng-click="loadFactionMatchups()" class="btn btn-small btn-default">Go</button>\n\t\t</form>\n\t\t\n\t\t<table class="table table-responsive table-stripped table-hover">\n\t\t\t<tr>\n\t\t\t\t<td>Faction</td>\n\t\t\t\t<td>Agenda</td>\n\t\t\t\t<td>Matchups</td>\n\t\t\t\t<td>Wins</td>\n\t\t\t\t<td>Losses</td>\n\t\t\t\t<td>Win Rate</td>\n\t\t\t</tr>\n\t\t\t\n\t\t\t<tr ng-repeat="entry in matchups" ng-if="entry.matches >= threshold">\n\t\t\t\t<td>{{entry.opponent_faction}}</td>\n\t\t\t\t<td>{{entry.opponent_agenda}}</td>\n\t\t\t\t<td><a href="javascript:void(0);" ng-click="show(search.faction, search.agenda, entry.opponent_faction, entry.opponent_agenda);">{{entry.matches}}</a></td>\n\t\t\t\t<td>{{entry.wins}}</td>\n\t\t\t\t<td>{{entry.losses}}</td>\n\t\t\t\t<td>{{(entry.wins / entry.matches) * 100 | number : 2}}%</td>\n\t\t\t</tr>\n\t\t\t\n\t\t</table>\n\t\t\n\t</div>\n</div>\n')}]),angular.module("js/stats/faction_wins_linechart.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/stats/faction_wins_linechart.html",'<div>\n\t<div class="card col-xs-12" style="min-width:800px;">\n\t\t<h3>Faction Wins by Date</h3>\n\t\t<canvas id="fwin-ytd"></canvas>\n\t</div>\n</div>\n')}]),angular.module("js/stats/match_details.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/stats/match_details.html",'<div class="modal" id="basicExample" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n    <div class="modal-dialog" role="document">\n        \x3c!--Content--\x3e\n        <div class="modal-content">\n            \x3c!--Header--\x3e\n            <div class="modal-header">\n            \t<button type="button" class="pull-right close" data-dismiss="modal" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n                <h4 class="modal-title w-100" id="myModalLabel">Matchup Details</h4>\n                \n            </div>\n            \x3c!--Body--\x3e\n            <div class="modal-body">\n                <table class="table table-responsive table-stripped">\n                \n                \t<tr ng-repeat="match in matches">\n                \t\t<td>\n                \t\t\t<span ng-if="match.player_1_id == match.winner_id">\n                \t\t\t<b>(W)</b>\n                \t\t\t</span>\n                \t\t\t<a href="player/{{match.player_1_id}}" onclick="$(\'.modal-backdrop\').remove();">{{match.player_1}}</a>\n                \t\t\t<span style="font-size:10px">({{match.player_1_elo}})</span>\n\t\t\t\t\t\t\t<br/>\n                \t\t\t<span ng-if="match.player_1_id == match.winner_id">\n                \t\t\t\t{{match.winner_faction}} <i>{{match.winner_agenda}}</i>\n                \t\t\t</span>\n\t\t\t\t\t\t\t<span ng-if="match.player_1_id == match.loser_id">\n                \t\t\t\t{{match.loser_faction}} <i>{{match.loser_agenda}}</i>\n                \t\t\t</span>\n                \t\t</td>\n                \t\t<td>\n                \t\t\t<span ng-if="match.player_2_id == match.winner_id">\n                \t\t\t<b>(W)</b>\n                \t\t\t</span>\n                \t\t\t<a href="player/{{match.player_2_id}}" onclick="$(\'.modal-backdrop\').remove();">{{match.player_2}}</a>\n                \t\t\t<span style="font-size:10px">({{match.player_2_elo}})</span>\n                \t\t\t<br/>\n\t\t\t\t\t\t\t<span ng-if="match.player_2_id == match.winner_id">\n                \t\t\t\t{{match.winner_faction}} <i>{{match.winner_agenda}}</i>\n                \t\t\t</span>\n\t\t\t\t\t\t\t<span ng-if="match.player_2_id == match.loser_id">\n                \t\t\t\t{{match.loser_faction}} <i>{{match.loser_agenda}}</i>\n                \t\t\t</span>\n                \t\t</td>\n                \t</tr>\n                \n                </table>\n            </div>\n            \x3c!--Footer--\x3e\n            <div class="modal-footer">\n                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n            </div>\n        </div>\n        \x3c!--/.Content--\x3e\n    </div>\n</div>')}]),angular.module("js/stats/played_factions_linechart.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/stats/played_factions_linechart.html",'<div>\n\t<div class="card col-xs-12" style="min-width:800px;">\n\t\t<h3>Faction Entires by Date</h3>\n\t\t<canvas id="fent-ytd"></canvas>\n\t</div>\n</div>\n')}]),angular.module("js/stats/stats.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/stats/stats.html","<faction-matchups></faction-matchups>\n<br/>&nbsp;<br/>\n<played-factions-linechart></played-factions-linechart>\n<br/>&nbsp;<br/>\n<faction-wins-linechart></played-factions-linechart>\n<br/>&nbsp;<br/>\n")}]),angular.module("js/whatsnew/whatsnew.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("js/whatsnew/whatsnew.html",'<div class="panel-group" id="accordion">\n\t<div class="panel panel-default" ng-repeat="u in updates">\n\t\t<div class="panel-heading">\n\t\t\t<h4 class="panel-title">\n\t\t\t\t<a class="accordion-toggle" ng-class="$index!=0?\'collapsed\':\'\'" href="javascript:void(0);" data-toggle="collapse" data-parent="#accordion" data-target="#collapse{{u.date}}" aria-expanded="false">{{u.date}}</a>\n\t\t\t</h4>\n\t\t</div>\n\t\t<div id="collapse{{u.date}}" class="panel-collapse collapse"  ng-class="$index!=0?\'\':\'in\'" aria-expanded="false">\n\t\t\t<div class="panel-body">\n\t\t\t\t<div ng-bind-html="toTrustedHTML(u.update)"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>')}]),app.directive("topPlayers",["Restangular","$routeParams","$route","$location","$q","Api",function(Rest,$routeParams,$route,$location,$q,Api){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/top_players.html",scope:{page:"=",mode:"&"},link:function(scope,elem,attrs){scope.pagination={offset:0,limit:20,page:scope.page},scope.loaded=!1,scope.loadTopPlayers=function(){scope.pagination.offset=scope.pagination.limit*(scope.pagination.page-1),Api.loadTopPlayers(scope.pagination).then(function(res){scope.top_players=res.data.players,scope.pagination.total=res.data.total.total,scope.pagination.page=scope.pagination.offset/scope.pagination.limit+1})},scope.changePage=function(){$location.path("/page/"+scope.pagination.page)},scope.loadTopPlayers()}}}]),app.directive("playerDetails",[function(){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/player_details.html",scope:{player:"=",mode:"&"}}}]),app.directive("playerNemesis",[function(){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/player_nemesis.html",scope:{player:"=",mode:"&"}}}]),app.directive("playerRival",[function(){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/player_rival.html",scope:{player:"=",mode:"&"}}}]),app.directive("playerTournaments",["Api",function(Api){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/player_tournaments.html",scope:{player:"=",mode:"&"},link:function(scope,element,attrs){scope.loadPlayerTournaments=function(){console.log("loading!"),Api.loadTournamentsByPlayer(scope.player.player_id).then(function(res){scope.tournaments=res.data,console.log(scope.tournaments)})}}}}]),app.directive("playerRounds",["Api",function(Api){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/player_rounds.html",scope:{tid:"=",player:"=",mode:"&"},link:function(scope,element,attrs){scope.loadPlayerRounds=function(){console.log("loading! - "+scope.tid+" -- "+scope.player.player_id),Api.loadTournamentRoundsByPlayer(scope.tid,scope.player.player_id).then(function(res){scope.rounds=res.data,console.log(scope.tournaments)})}}}}]),app.directive("factionWinloss",["Api","ColorManager",function(Api,ColorManager){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/player/faction_winloss.html",scope:{player:"=",mode:"&"},link:function(scope,elem,attrs){scope.loadFactionWinLoss=function(player){Api.loadFactionWinLoss(player).then(function(res){scope.faction_data=res.data.faction_win_loss,scope.agenda_data=res.data.faction_agenda_win,scope.buildChart(),scope.buildPieChart()})},scope.hexToRGB=function(hex,alpha){var r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);return alpha?"rgba("+r+", "+g+", "+b+", "+alpha+")":"rgb("+r+", "+g+", "+b+")"},scope.buildChart=function(){var dataPack1=[],dataPack2=[],labels=[],colors=[],colors2=[];angular.forEach(scope.faction_data,function(value,key){dataPack1.push(value.wins),dataPack2.push(value.losses),labels.push(value.faction),colors.push(ColorManager.getBGColor(value.faction)),colors2.push(scope.hexToRGB(ColorManager.getBGColor(value.faction),.4))});var data={type:"horizontalBar",data:{labels:labels,datasets:[{label:"Wins",data:dataPack1,backgroundColor:colors,hoverBackgroundColor:colors,hoverBorderWidth:2,hoverBorderColor:"lightgrey"},{label:"Losses",data:dataPack2,backgroundColor:colors2,hoverBackgroundColor:colors2,hoverBorderWidth:2,hoverBorderColor:"lightgrey"}]},options:{animation:{duration:10},tooltips:{mode:"label",callbacks:{label:function(tooltipItem,data){return data.datasets[tooltipItem.datasetIndex].label+": "+tooltipItem.xLabel}}},scales:{xAxes:[{stacked:!0,gridLines:{display:!1}}],yAxes:[{stacked:!0,ticks:{callback:function(value){return value}}}]},legend:{display:!1},responsive:!0}},bar_ctx=document.getElementById("fwl-"+scope.player);new Chart(bar_ctx,data)},scope.buildPieChart=function(){var dataset=[],colors=[],labels=[],fontColor=[],dataset2=[],colors2=[],labels2=[],fontColor2=[];angular.forEach(scope.faction_data,function(value,key){labels.push(ColorManager.getDisplayText(value.faction)),dataset.push(value.wins),colors.push(ColorManager.getBGColor(value.faction)),fontColor.push(ColorManager.getTextColor(value.faction))}),angular.forEach(scope.agenda_data,function(value,key){""==value.agenda?(labels2.push("Unknown"),colors2.push("#f442f4"),fontColor2.push("#000")):(labels2.push(ColorManager.getDisplayText(value.faction)+" "+ColorManager.getDisplayText(value.agenda)),colors2.push(ColorManager.getBGColor(value.agenda)),fontColor2.push(ColorManager.getTextColor(value.agenda))),dataset2.push(value.wins)});var ctx=document.getElementById("wd-"+scope.player).getContext("2d"),ctx2=(new Chart(ctx,{type:"pie",data:{labels:labels,datasets:[{backgroundColor:colors,data:dataset,fontColors:fontColor}]},options:{legend:{display:!1},responsive:!1,tooltips:{enabled:!1,custom:getCustomTooltipFunction(0,"wd-"+scope.player+"-tooltip")},pieceLabel:{mode:"label",tocenter:!0,fontSize:14}}}),document.getElementById("wd-outter-"+scope.player).getContext("2d"));new Chart(ctx2,{type:"doughnut",data:{labels:labels2,datasets:[{backgroundColor:colors2,data:dataset2,fontColors:fontColor2}]},options:{cutoutPercentage:90,legend:{display:!1},responsive:!1,tooltips:{enabled:!1,custom:getCustomTooltipFunction(0,"wd-"+scope.player+"-tooltip")}}})},scope.loadFactionWinLoss(scope.player)}}}]),app.directive("playedFactionsLinechart",["Api","ColorManager",function(Api,ColorManager){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/stats/played_factions_linechart.html",scope:{player:"=",mode:"&"},link:function(scope,elem,attrs){scope.loadFactionEntryCounts=function(player){scope.processed_data={},Api.loadFactionEntries().then(function(result){var res=result.data;scope.processed_data.date_keys=Array(),scope.processed_data.dates=Array();for(var i=0;i<res.length;i++)scope.processed_data[res[i].faction]||(scope.processed_data[res[i].faction]=Array()),scope.processed_data[res[i].faction].push(res[i].entries),scope.processed_data.date_keys[res[i].mdate]||(scope.processed_data.date_keys[res[i].mdate]=res[i].date_stamp,scope.processed_data.dates.push(res[i].date_stamp));scope.buildChart()})},scope.hexToRGB=function(hex,alpha){var r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);return alpha?"rgba("+r+", "+g+", "+b+", "+alpha+")":"rgb("+r+", "+g+", "+b+")"},scope.buildChart=function(){var config={type:"line",data:{labels:scope.processed_data.dates,datasets:[{label:"Lannister",backgroundColor:ColorManager.getBGColor("Lannister"),borderColor:ColorManager.getBGColor("Lannister"),data:scope.processed_data.Lannister,fill:!1},{label:"Baratheon",fill:!1,backgroundColor:ColorManager.getBGColor("Baratheon"),borderColor:ColorManager.getBGColor("Baratheon"),data:scope.processed_data.Baratheon},{label:"Greyjoy",fill:!1,backgroundColor:ColorManager.getBGColor("Greyjoy"),borderColor:ColorManager.getBGColor("Greyjoy"),data:scope.processed_data.Greyjoy},{label:"Tyrell",fill:!1,backgroundColor:ColorManager.getBGColor("Tyrell"),borderColor:ColorManager.getBGColor("Tyrell"),data:scope.processed_data.Tyrell},{label:"Stark",fill:!1,backgroundColor:ColorManager.getBGColor("Stark"),borderColor:ColorManager.getBGColor("Stark"),data:scope.processed_data.Stark},{label:"Martell",fill:!1,backgroundColor:ColorManager.getBGColor("Martell"),borderColor:ColorManager.getBGColor("Martell"),data:scope.processed_data.Martell},{label:"Night's Watch",fill:!1,backgroundColor:ColorManager.getBGColor("Night's Watch"),borderColor:ColorManager.getBGColor("Night's Watch"),data:scope.processed_data["Night's Watch"]},{label:"Targaryen",fill:!1,backgroundColor:ColorManager.getBGColor("Targaryen"),borderColor:ColorManager.getBGColor("Targaryen"),data:scope.processed_data.Targaryen}]},options:{responsive:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Month"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Value"}}]}}},ctx=document.getElementById("fent-ytd");new Chart(ctx,config)},scope.loadFactionEntryCounts()}}}]),app.directive("factionWinsLinechart",["Api","ColorManager",function(Api,ColorManager){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/stats/faction_wins_linechart.html",scope:{player:"=",mode:"&"},link:function(scope,elem,attrs){scope.loadFactionEntryCounts=function(player){scope.processed_data={},Api.loadFactionWins().then(function(result){var res=result.data;console.log("got them!"),console.log(res),scope.processed_data.date_keys=Array(),scope.processed_data.dates=Array();for(var i=0;i<res.length;i++)scope.processed_data[res[i].faction]||(scope.processed_data[res[i].faction]=Array()),scope.processed_data[res[i].faction].push(res[i].wins),scope.processed_data.date_keys[res[i].mdate]||(scope.processed_data.date_keys[res[i].mdate]=res[i].date_stamp,scope.processed_data.dates.push(res[i].date_stamp));console.log(scope.processed_data),scope.buildChart()})},scope.hexToRGB=function(hex,alpha){var r=parseInt(hex.slice(1,3),16),g=parseInt(hex.slice(3,5),16),b=parseInt(hex.slice(5,7),16);return alpha?"rgba("+r+", "+g+", "+b+", "+alpha+")":"rgb("+r+", "+g+", "+b+")"},scope.buildChart=function(){var config={type:"line",data:{labels:scope.processed_data.dates,datasets:[{label:"Lannister",backgroundColor:ColorManager.getBGColor("Lannister"),borderColor:ColorManager.getBGColor("Lannister"),data:scope.processed_data.Lannister,fill:!1},{label:"Baratheon",fill:!1,backgroundColor:ColorManager.getBGColor("Baratheon"),borderColor:ColorManager.getBGColor("Baratheon"),data:scope.processed_data.Baratheon},{label:"Greyjoy",fill:!1,backgroundColor:ColorManager.getBGColor("Greyjoy"),borderColor:ColorManager.getBGColor("Greyjoy"),data:scope.processed_data.Greyjoy},{label:"Tyrell",fill:!1,backgroundColor:ColorManager.getBGColor("Tyrell"),borderColor:ColorManager.getBGColor("Tyrell"),data:scope.processed_data.Tyrell},{label:"Stark",fill:!1,backgroundColor:ColorManager.getBGColor("Stark"),borderColor:ColorManager.getBGColor("Stark"),data:scope.processed_data.Stark},{label:"Martell",fill:!1,backgroundColor:ColorManager.getBGColor("Martell"),borderColor:ColorManager.getBGColor("Martell"),data:scope.processed_data.Martell},{label:"Night's Watch",fill:!1,backgroundColor:ColorManager.getBGColor("Night's Watch"),borderColor:ColorManager.getBGColor("Night's Watch"),data:scope.processed_data["Night's Watch"]},{label:"Targaryen",fill:!1,backgroundColor:ColorManager.getBGColor("Targaryen"),borderColor:ColorManager.getBGColor("Targaryen"),data:scope.processed_data.Targaryen}]},options:{responsive:!0,tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Month"}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Value"}}]}}},ctx=document.getElementById("fwin-ytd");new Chart(ctx,config)},scope.loadFactionEntryCounts()}}}]),app.directive("factionMatchups",["Api","ColorManager","ModalService",function(Api,ColorManager,ModalService){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/stats/faction_matchups.html",scope:{player:"=",mode:"&"},link:function(scope,elem,attrs){scope.search={},scope.threshold=0,scope.show=function(f1,a1,f2,a2){var params={faction:f1,agenda:a1,faction_2:f2,agenda_2:a2,date:scope.search.date};ModalService.showModal({templateUrl:"js/stats/match_details.html",controller:"MatchupDetailsController",inputs:{params:params}}).then(function(modal){modal.element.modal(),modal.close.then(function(result){scope.message="You said "+result})})},scope.loadFactionMatchups=function(search){Api.loadFactionMatchups(scope.search).then(function(res){scope.search.date=res.data.date,scope.search.faction=res.data.faction,scope.search.agenda=res.data.agenda,scope.matchups=res.data.results})},scope.loadFactions=function(){Api.loadFactions(scope.search).then(function(res){scope.factions=res.data.factions,scope.agendas=res.data.agendas})},scope.loadFactions(),scope.loadFactionMatchups()}}}]);var MainCtrl=app.controller("MatchupDetailsController",["$scope","params","close","Api",function($scope,params,close,Api){$scope.params=params,$scope.matches={},$scope.loadMatchupDetails=function(){Api.loadFactionMatchupDetails($scope.params).then(function(res){$scope.matches=res.data})},$scope.close=function(result){close(null,500)},$scope.loadMatchupDetails()}]);app.factory("PlayerSearch",["Restangular","$rootScope","$q","$location","$http","Api",function(Rest,$rootScope,$q,$location,$http,Api){"use strict";window.Api=this;return{setSearchStr:function(search_str){console.log("setting search str : "+search_str),this.search_str=search_str,console.log("after setting?"),console.log(this.search_str)},searchPlayers:function(){var that=this,defer=$q.defer();return Api.searchPlayers({playerName:that.search_str}).then(function(res){console.log("returning with that.players??"),that.players=res.data,console.log(that.players),defer.resolve(res.data)},function(err){defer.reject(err)}),defer.promise}}}]);var MainCtrl=app.controller("SearchController",["$scope","Restangular","$routeParams","$route","$location","$q","Api","PlayerSearch",function($scope,Rest,$routeParams,$route,$location,$q,Api,PlayerSearch){$scope.ps=PlayerSearch,$scope.players=$scope.ps.players,$scope.loading=!1}]);app.directive("playerSearch",["Restangular","$routeParams","$route","$location","$q","Api","PlayerSearch",function(Rest,$routeParams,$route,$location,$q,Api,PlayerSearch){"use strict";return{restrict:"EA",replace:!0,transclude:!1,templateUrl:"js/search/search_form.tpl.html",scope:{page:"=",mode:"&"},link:function(scope,elem,attrs){console.log("IN PLAYER SEARCH DIRECTIVE!!!!"),scope.ps=PlayerSearch,scope.pagination={offset:0,limit:20,page:scope.page},scope.loaded=!1,scope.searchPlayer=function(){console.log("search player!"),scope.ps.searchPlayers().then(function(){$location.path("/search")})},scope.ps.search_str&&scope.searchPlayer()}}}]);var FaqCtrl=app.controller("FaqController",["$scope","Restangular","$routeParams","$route","$location","$q","Api","$sce",function($scope,Rest,$routeParams,$route,$location,$q,Api,$sce){$scope.loading=!1,$scope.faqs=[{id:1,q:"What is Isle of Ravens?",a:'Isle of Ravens is a site that collects tournament entries for A Game of Thrones LCG 2nd edition and generates an Elo rating for each player based on their performance.  Data is sourced from <a href="http://thejoustingpavilion.com" target="_blank">The Jousting Pavilion</a> and fetches new results hourly.  Due to API limitations, we can only pull in data for completed tournaments.'},{id:2,q:"What is an Elo Rating",a:"Officially, 'The Elo rating system is a method for calculating the relative skill levels of players in competitor-versus-competitor games such as chess. It is named after its creator Arpad Elo, a Hungarian-born American physics professor.'"},{id:3,q:"Where does this data come from and how often is it updated?",a:'IoR will check for new entries on <a href="http://thejoustingpavilion.com" target="_blank">The Jousting Pavilion</a> every hour and generate updated Elo ratings based on the new results.  At this time we can only pull in data for completed tournaments, so your Elo will not updated until the end of an event.'},{id:4,q:"I had my name merged on TJP, when will my Elo update?",a:"You will have to notify us when a historical change happens.  Because a single change in a player or tournament ripples through the data, effecting an increasingly branching set of Elo ratings, we have to re-run all of the data.  To be kind to the data sources we rely on, this is only done per request and not automatically."},{id:5,q:"I had a tournament for a different game deleted from TJP, when will my Elo Update?",a:"You will have to notify us when a historical change happens.  Because a single change in a player or tournament ripples through the data, effecting an increasingly branching set of Elo ratings, we have to re-run all of the data.  To be kind to the data sources we rely on, this is only done per request and not automatically."},{id:6,q:"Why did tournament X not affect my Elo?",a:"Elo ratings depend on round by round data being available.  If this there are no rounds available, we can't calculate a new Elo."}],$scope.toTrustedHTML=function(html){return $sce.trustAsHtml(html)}}]),ContactCtrl=app.controller("ContactController",["$scope","Restangular","$routeParams","$route","$location","$q","Api","$sce","$http",function($scope,Rest,$routeParams,$route,$location,$q,Api,$sce,$http){$scope.success=!1,$scope.error=!1,$scope.sending=!1,$scope.user={},$scope.send=function(){$scope.sending=!0,Api.sendMail($scope.user).then(function(res){console.log(res),console.log($scope.user),$scope.success=!0,$scope.error=!1},function(response){$scope.error=!0,$scope.success=!1,console.log("Error with status code",response.status)})}}]),FaqCtrl=app.controller("WhatsNewController",["$scope","Restangular","$routeParams","$route","$location","$q","Api","$sce",function($scope,Rest,$routeParams,$route,$location,$q,Api,$sce){$scope.loading=!1,$scope.updates=[{date:"2017-08-01",update:"<ol><li>Fixed an issue with the data processor.  This was causing game results to lock in a loop and get recorded multiple times.</li><li>Pulled a fresh data set to fix errors from above and catch the latest name changes/merges.</li><li>Added additional information to the backend for some cool future features involving pulling stats.</li><li>Added a stats page to show some general stats (right now it's just faction entries YTD).</li></ol>"},{date:"2017-06-18",update:"<ol><li>Added pagination for top players, allowing seeing all players in the system</li><li>Changed how the search functions, now redirects to it's own page.</li><li>Search is now available from all pages.</li><li>Optomized UI layout.</li><li>Replaced google charts with charts.js.  More flexible and optomized for our purposes</li><li>Updated to material design elements.</li><li>Added 'What's new' page.</li><li>Fixed overflow issue with 'FAQ' and 'What's New' pages on initial load.</li></ol>"},{date:"2017-06-16",update:"<ol><li>Re-pulled all data to account for TJP name merges.</li><li>Added FAQ & Contact pages</li><li>Added player faction stats graph to player cards</li></ol>"}],$scope.toTrustedHTML=function(html){return $sce.trustAsHtml(html)}}]);app.directive("activeLink",["$location",function(location){return{restrict:"A",link:function(scope,element,attrs,controller){var clazz=attrs.activeLink,path="/"+attrs.link;console.log("checking path of "+path),scope.location=location,scope.$watch("location.path()",function(newPath){path===newPath?element.addClass(clazz):element.removeClass(clazz)})}}}]),app.factory("ColorManager",["Restangular","$rootScope","$q","$location","$http","Api",function(Rest,$rootScope,$q,$location,$http,Api){"use strict";window.CM=this;var CM=this;return this.cache={},this.colors=[{name:"Lannister",display:"Lannister",colors:{bg:"#C00106",text:"#FE9A9D"}},{name:"Stark",display:"Stark",colors:{bg:"#CFCFCF",text:"#333333"}},{name:"Targaryen",display:"Targaryen",colors:{bg:"#1C1C1C",text:"#CCCCCC"}},{name:"Greyjoy",display:"Greyjoy",colors:{bg:"#1D7A99",text:"#A9DDEF"}},{name:"Tyrell",display:"Tyrell",colors:{bg:"#509F16",text:"#C6F3A5"}},{name:"Baratheon",display:"Baratheon",colors:{bg:"#E3D852",text:"#5F5911"}},{name:"Night's Watch",display:"Night's Watch",colors:{bg:"#7A7A7A",text:"#333333"}},{name:"Martell",display:"Martell",colors:{bg:"#E89521",text:"#5C3A0A"}},{name:"Banner of the Lion",display:"Lion",colors:{bg:"#C00106",text:"#FE9A9D"}},{name:"Banner of the Wolf",display:"Wolf",colors:{bg:"#CFCFCF",text:"#333333"}},{name:"Banner of the Dragon",display:"Dragon",colors:{bg:"#1C1C1C",text:"#CCCCCC"}},{name:"Banner of the Kraken",display:"Kraken",colors:{bg:"#1D7A99",text:"#A9DDEF"}},{name:"Banner of the Rose",display:"Rose",colors:{bg:"#509F16",text:"#C6F3A5"}},{name:"Banner of the Stag",display:"Stag",colors:{bg:"#E3D852",text:"#5F5911"}},{name:"Banner of the Watch",display:"Watch",colors:{bg:"#7A7A7A",text:"#333333"}},{name:"Banner of the Sun",display:"Sun",colors:{bg:"#E89521",text:"#5C3A0A"}},{name:"Fealty",display:"Fealty",colors:{bg:"#7B0B20",text:"#F7A1B1"}},{name:"No agenda",display:"No agenda",colors:{bg:"#A99560",text:"#5A540F"}},{name:"The Lord of the Crossing",display:"Crossing",colors:{bg:"#6692A0",text:"#27393F"}},{name:"Kings of Summer",display:"Summer",colors:{bg:"#FCD700",text:"#665700"}},{name:"Kings of Winter",display:"Winter",colors:{bg:"#1C88D0",text:"#0C3B5A"}},{name:'"The Rains of Castamere"',display:"Rains",colors:{bg:"#D75B4D",text:"#5E1F18"}},{name:"Alliance",display:"Alliance",colors:{bg:"#845D70",text:"#1C1C1C"}},{name:"Protectors of the Realm",display:"Protectors",colors:{bg:"",text:""}},{name:"The Power of Wealth",display:"Power of Wealth",colors:{bg:"",text:""}},{name:"Treaty",display:"Treaty",colors:{bg:"",text:""}},{name:"Uniting the Seven Kingdoms",display:"Uniting",colors:{bg:"",text:""}}],{getBGColor:function(name){return CM.cache&&CM.cache.name==name||(CM.cache=_.find(CM.colors,function(o){return o.name==name})),CM.cache.colors.bg},getTextColor:function(name){return CM.cache&&CM.cache.name==name||(CM.cache=_.find(CM.colors,function(o){return o.name==name})),CM.cache.colors.text},getDisplayText:function(name){return CM.cache&&CM.cache.name==name||(CM.cache=_.find(CM.colors,function(o){return o.name==name})),CM.cache.display},findObj:function(name){var res={};return console.log(CM.colors),console.log("there were colors..."),angular.forEach(CM.colors,function(value,key){console.log("check "+value.name+" against "+name),value.name==name&&(res=value)}),res}}}]);